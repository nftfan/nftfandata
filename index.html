<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFT FANS TOKEN DATABASE</title>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1002.0.min.js"></script>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #0d1117; /* Dark background */
        color: #c9d1d9; /* Light text color */
        font-size: 16px;
    }

    .container {
        width: 90%;
        margin: 20px auto;
        padding: 20px;
        box-sizing: border-box;
        background-color: #161b22; /* Dark container background */
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    input[type="text"] {
        width: 100%;
        padding: 12px;
        border: 1px solid #30363d; /* Dark border color */
        border-radius: 4px;
        margin-bottom: 10px;
        font-size: 16px;
        background-color: #161b22; /* Dark input background */
        color: #c9d1d9; /* Light text color */
    }

    button {
        width: 100%;
        padding: 12px;
        background-color: #238636; /* Green button color */
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        transition: background-color 0.3s ease;
    }

    button:hover {
        background-color: #1d7432; /* Darker green on hover */
    }

    .error {
        color: #ff6b6b; /* Red error message color */
        margin-bottom: 10px;
        font-size: 14px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        font-size: 16px;
        color: #c9d1d9;
    }

    th, td {
        border: 1px solid #30363d;
        padding: 8px;
        text-align: left;
    }

    th {
        background-color: #0d1117; /* Dark header background */
    }

    .highlighted-row {
        background-color: #30363d; /* Dark row highlight color */
    }

    /* Dark mode toggle */
    .dark-mode-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 9999;
        background-color: transparent;
        border: none;
        cursor: pointer;
        font-size: 20px;
        color: #c9d1d9;
    }
</style>



</head>
<body>

<div class="container">
    <h2>NFTFANS TOKEN DATABASE</h2>
    <input type="text" id="walletAddress" placeholder="Enter your wallet address">
    <input type="text" id="twitterUsername" placeholder="Enter your Twitter username (starting with '@')">
    <button onclick="postWalletAndUsername()">Post</button>
    <div class="error" id="errorMessage"></div>
    
    <table id="walletTable">
        <thead>
            <tr>
                
            </tr>
        </thead>
        <tbody id="walletTableBody">
            <!-- Wallets and usernames will be displayed here -->
        </tbody>
    </table>
</div>

<script>
    // Configure AWS SDK
    AWS.config.update({
        region: 'eu-north-1',
        credentials: new AWS.Credentials('AKIAVRUVVVUMTKXLCDO6', '2PkALOW/h0MecUTcWdNkAxQM8mNhV33H7nH9sTGq')
    });
    
    var dynamodb = new AWS.DynamoDB.DocumentClient();
    var tableName = 'nftfan'; // Updated table name
    
    // Array to store unique wallets and usernames
var uniqueWallets = [];
var uniqueUsernames = [];

// Function to post wallets and usernames
function postWalletAndUsername() {
    var walletAddress = document.getElementById("walletAddress").value.trim();
    var twitterUsername = document.getElementById("twitterUsername").value.trim();
    
    // Check if wallet address and username are provided
    if (!walletAddress || !twitterUsername) {
        displayError("Both wallet address and Twitter username are required.");
        return;
    }
    
    // Check if Twitter username starts with '@'
    if (!twitterUsername.startsWith('@')) {
        displayError("Twitter username must start with '@'.");
        return;
    }
    
    // Check if wallet or username already exists
    if (uniqueWallets.includes(walletAddress)) {
        displayError("This wallet address has already been submitted.");
        return;
    }
    
    if (uniqueUsernames.includes(twitterUsername)) {
        displayError("This Twitter username has already been submitted.");
        return;
    }
    
    // Generate a unique identifier for the item
    var nftfanId = 'nftfan_' + Date.now();
    
    // Generate random tokens won and multiply by 1 trillion
    var tokensWon = (Math.floor(Math.random() * 1000) + 1) * 1000000000000;
    
    // Put item into DynamoDB
    var params = {
        TableName: tableName,
        Item: {
            nftfan: nftfanId, // Include a unique identifier
            walletAddress: walletAddress,
            twitterUsername: twitterUsername,
            tokensWon: tokensWon // Set the tokens won
        }
    };
    
    dynamodb.put(params, function(err, data) {
        if (err) {
            displayError("Error saving wallet and username to DynamoDB: " + err.message);
        } else {
            clearError();
            console.log("Successfully saved wallet and username to DynamoDB", data);
            // Update arrays with new wallet address and username
            uniqueWallets.push(walletAddress);
            uniqueUsernames.push(twitterUsername);
            loadWalletsAndUsernames(); // Reload wallets and usernames after saving
        }
    });
    
    // Clear input fields after posting
    document.getElementById("walletAddress").value = "";
    document.getElementById("twitterUsername").value = "";
}



    
    // Function to load wallets and usernames from DynamoDB
function loadWalletsAndUsernames() {
    var params = {
        TableName: tableName
    };
    
    dynamodb.scan(params, function(err, data) {
        if (err) {
            displayError("Error loading wallets and usernames from DynamoDB: " + err.message);
        } else {
            clearError();
            console.log("Successfully loaded wallets and usernames from DynamoDB", data);
            displayWalletsAndUsernames(data.Items);

            // Highlight row containing @nftfanstoken
            highlightRowContainingUsername(data.Items, "@nftfanstoken");
        }
    });
}

// Function to highlight the row containing a specific username
function highlightRowContainingUsername(data, username) {
    var walletTableBody = document.getElementById("walletTableBody");

    for (var i = 0; i < data.length; i++) {
        if (data[i].twitterUsername === username) {
            // Get the row corresponding to the username and add a CSS class for highlighting
            var row = walletTableBody.rows[i];
            row.classList.add("highlighted-row");
            break; // Stop searching after finding the first occurrence
        }
    }
}

// Function to display wallets and usernames sorted by tokens won
function displayWalletsAndUsernames(walletsAndUsernames) {
    var walletTableBody = document.getElementById("walletTableBody");
    walletTableBody.innerHTML = ""; // Clear existing entries

    // Sort the array of items by tokens won (descending order)
    walletsAndUsernames.sort(function(a, b) {
        return b.tokensWon - a.tokensWon;
    });

    // Add column titles
    var headerRow = walletTableBody.insertRow(0);
    headerRow.insertCell(0).textContent = "#";
    headerRow.insertCell(1).textContent = "NFTFAN";
    headerRow.insertCell(2).textContent = "X username";
    headerRow.insertCell(3).textContent = "Wallet";
    headerRow.insertCell(4).textContent = "Tokens Won";

    walletsAndUsernames.forEach(function (item, index) {
        var row = walletTableBody.insertRow(index + 1); // Start from the second row (index + 1)

        // Insert the index in the row
        row.insertCell(0).textContent = walletsAndUsernames.length - index; // Adjust the index to start from 1
        
        // Insert the image with OpenSea link in the row
        var nftCell = row.insertCell(1);
        var image = document.createElement("img");
        if (item.twitterUsername === '@nftfanstoken') {
            image.src = "https://i.seadn.io/s/raw/files/4ee38fcd8ce97b2f52ab5257e036c359.png?auto=format&dpr=1&w=1000";
        } else if (item.twitterUsername === '@cottons123') {
            image.src = "https://i.seadn.io/s/raw/files/6f229cee3648016dcc20bfb7dde5aed7.png?auto=format&dpr=1&w=1000";
        } else {
            image.src = "https://i.seadn.io/s/raw/files/749021b85f1f70dd027a146fd7532039.png?auto=format&dpr=1&w=10&h=10";
        }
        image.width = 30;
        image.height = 30;
        var openSeaLink = document.createElement("a");
        openSeaLink.href = "https://opensea.io/collection/nftfans-fans";
        openSeaLink.target = "_blank";
        openSeaLink.appendChild(image);
        nftCell.appendChild(openSeaLink);
        
        var usernameCell = row.insertCell(2);
        usernameCell.innerHTML = '<a href="https://twitter.com/' + item.twitterUsername.substring(1) + '" style="color: red;">' + item.twitterUsername + '</a>';
        row.insertCell(3).textContent = item.walletAddress;
        row.insertCell(4).textContent = item.tokensWon.toLocaleString();

        // Add click event listener to open Twitter profile
        usernameCell.addEventListener('click', function() {
            window.open('https://twitter.com/' + item.twitterUsername.substring(1), '_blank');
        });
    });
}





    
    // Function to display error messages
    function displayError(message) {
        var errorMessage = document.getElementById("errorMessage");
        errorMessage.textContent = message;
    }
    
    // Function to clear error messages
    function clearError() {
        var errorMessage = document.getElementById("errorMessage");
        errorMessage.textContent = "";
    }
    
    // Load wallets and usernames when the page loads
    window.onload = function() {
        loadWalletsAndUsernames();
    };
</script>
</body>
</html>
